```bash
sudo nano /etc/suricata/suricata.yaml
```

`nano` editor ထဲရောက်သွားပြီဆိုရင် အောက်ပါ key တွေကို အသုံးများပါတယ်-

- **ရှာဖွေရန် (Search):** `Ctrl + W` ကိုနှိပ်ပြီး ကိုယ်ရှာချင်တဲ့ စာသား (ဥပမာ- `HOME_NET`) ကို ရိုက်ထည့်ပြီး ရှာနိုင်ပါတယ်။
- **သိမ်းဆည်းရန် (Save):** ပြင်ဆင်ပြီးသွားရင် `Ctrl + O` ကိုနှိပ်၊ ပြီးရင် `Enter` ခေါက်ပါ။
- **ထွက်ရန် (Exit):** `Ctrl + X` ကိုနှိပ်ပါ။

### ပြင်ဆင်ပြီးရင် စစ်ဆေးဖို့ မမေ့ပါနဲ့

ဖိုင်ကို ပြင်ပြီးတာနဲ့ တစ်ခုခုမှားသွားသလား သိနိုင်ဖို့ ဒီ command နဲ့ အမြဲ စစ်ဆေးပေးပါ-

```bash
sudo suricata -T -c /etc/suricata/suricata.yaml -v
```

`suricata.yaml` ထဲမှာ **HOME_NET** နဲ့ **af-packet** အပိုင်းတွေဟာ Suricata တစ်ခုလုံးရဲ့ စွမ်းဆောင်ရည်နဲ့ တိကျမှုအတွက် အရေးအကြီးဆုံး အစိတ်အပိုင်းတွေ ဖြစ်ပါတယ်။

---

## ၁။ HOME_NET (ကာကွယ်မည့် ကွန်ရက်)

**HOME_NET** ဆိုတာကတော့ Suricata ကို "ငါ့ရဲ့ ကွန်ရက်က ဒါတွေဖြစ်တယ်၊ ဒါတွေကို မင်း စောင့်ရှောက်ပေးရမယ်" လို့ သတ်မှတ်ပေးတဲ့ variable တစ်ခု ဖြစ်ပါတယ်။

- **ဘာကြောင့် အရေးကြီးတာလဲ:** Suricata rules တွေမှာ `alert tcp $EXTERNAL_NET any -> $HOME_NET any` စသဖြင့် ရေးထားလေ့ရှိပါတယ်။ အကယ်၍ `HOME_NET` ကို မှန်အောင် မသတ်မှတ်ထားရင် Suricata က ဘယ်ဟာက အပြင်က တိုက်ခိုက်မှု၊ ဘယ်ဟာက အတွင်းက ပုံမှန်သွားလာမှုဆိုတာကို မခွဲခြားနိုင်တော့ဘဲ Alerts တွေ မှားပြတာမျိုး (False Positives) ဖြစ်တတ်ပါတယ်။

**သတ်မှတ်ပုံ နမူနာ:**

```yaml
vars:
  address-groups:
    HOME_NET: "[192.168.1.0/24]" # ကိုယ့် LAN IP range
    EXTERNAL_NET: "!$HOME_NET" # Home Net မဟုတ်သမျှ အပြင်ကွန်ရက်
```

---

## ၂။ af-packet (Packet ဖမ်းယူသည့် နည်းလမ်း)

**af-packet** ဆိုတာကတော့ Linux Kernel ထဲကနေ Network Traffic (Packets) တွေကို အမြန်နှုန်း မြင့်မြင့်နဲ့ ဖမ်းယူပြီး Suricata ဆီ ပို့ပေးတဲ့ Engine တစ်ခု ဖြစ်ပါတယ်။ ၎င်းဟာ ခေတ်မီ Linux system တွေမှာ အသုံးအများဆုံးနဲ့ စွမ်းဆောင်ရည်အကောင်းဆုံး နည်းလမ်း ဖြစ်ပါတယ်။

### af-packet ထဲမှာ ပါတဲ့ အရေးကြီးတဲ့ အချက်များ:

1. **Interface:** ဘယ် Network Card ကနေ traffic ဖမ်းမလဲဆိုတာ သတ်မှတ်ရပါတယ်။ (ဥပမာ- `eth0`, `enp0s3`)
2. **Cluster-id:** Suricata ကို process အများကြီးနဲ့ ခွဲပြီး အလုပ်လုပ်ခိုင်းရင် ဒီ ID ကို သုံးပါတယ်။
3. **Cluster-type:** `cluster_flow` လို့ ထားလေ့ရှိပါတယ်။ ဒါဟာ packet တစ်ခုချင်းစီကို သက်ဆိုင်ရာ flow အလိုက် စနစ်တကျ ခွဲခြမ်းစိတ်ဖြာဖို့ ဖြစ်ပါတယ်။
4. **Threads:** ကိုယ့် CPU ရဲ့ core အရေအတွက်အလိုက် အလုပ်လုပ်မယ့် thread အရေအတွက်ကို `auto` ထားနိုင်သလို သီးသန့်လည်း သတ်မှတ်နိုင်ပါတယ်။

**သတ်မှတ်ပုံ နမူနာ:**

```yaml
af-packet:
  - interface: eth0 # ကိုယ့် network card အမည်
    cluster-id: 99
    cluster-type: cluster_flow
    defrag: yes
    use-mmap: yes # Speed ပိုမြန်စေဖို့ memory mapping သုံးတာပါ
```

---

## ၃။ အနှစ်ချုပ် နှိုင်းယှဉ်ချက်

| အပိုင်း       | အဓိက တာဝန်                           | ပြင်ဆင်ရမည့် နေရာ             |
| ------------- | ------------------------------------ | ----------------------------- |
| **HOME_NET**  | **ဘယ်သူ့ကို** ကာကွယ်မလဲ (Who)        | `vars:` section အောက်မှာ      |
| **af-packet** | Traffic ကို **ဘယ်လို** ဖမ်းမလဲ (How) | `af-packet:` section အောက်မှာ |

### သိထားသင့်သည့် အချက်

အကယ်၍ သင်က Suricata ကို **IDS** (စောင့်ကြည့်ရုံ) အဖြစ်တင်မကဘဲ **IPS** (တိုက်ခိုက်မှုကို တားဆီးရန်) အနေနဲ့ သုံးချင်တယ်ဆိုရင် `af-packet` ရဲ့ `copy-mode` (ဥပမာ- `ips` mode) ကို အသုံးပြုပြီး Network Card နှစ်ခုကြားမှာ တားဆီးပေးအောင် လုပ်ဆောင်ရမှာ ဖြစ်ပါတယ်။
