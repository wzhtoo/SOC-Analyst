# Rules

- `sudo suricata-update`

`sudo suricata-update` ဆိုတာ Suricata ရဲ့ **"Security Rules (တိုက်ခိုက်မှုကို ရှာဖွေဖော်ထုတ်ပေးတဲ့ စည်းမျဉ်းများ)"** ကို အမြဲတမ်း နောက်ဆုံးပေါ် (Update) ဖြစ်နေအောင် လုပ်ဆောင်ပေးတဲ့ Tool တစ်ခု ဖြစ်ပါတယ်။

ရိုးရိုးရှင်းရှင်း ပြောရရင် - Antivirus တစ်ခုမှာ Virus တွေကို သိဖို့ **Virus Database** ကို Update လုပ်ပေးရသလိုမျိုးပဲ၊ Suricata မှာလည်း Network တိုက်ခိုက်မှုအသစ်တွေကို သိဖို့အတွက် **Rules** တွေကို Update လုပ်ပေးရတာပါ။

---

### ၁။ `suricata-update` က ဘာတွေလုပ်ပေးသလဲ?

ဒီ command ကို ရိုက်လိုက်တဲ့အခါ သူက အောက်ပါအဆင့်တွေကို အလိုအလျောက် လုပ်ဆောင်ပေးပါတယ်-

1. **Download ပြုလုပ်ခြင်း:** ကမ္ဘာတစ်ဝှမ်းက နောက်ဆုံးပေါ် တိုက်ခိုက်မှုတွေကို စောင့်ကြည့်နေတဲ့ **Emerging Threats (ET) Open Rules** စာရင်းထဲကနေ rule အသစ်တွေကို ဒေါင်းလုဒ်ဆွဲပါတယ်။
2. **စုစည်းခြင်း (Merging):** Rule ဖိုင်ပေါင်းများစွာကို Suricata ဖတ်ရလွယ်အောင် `suricata.rules` ဆိုတဲ့ ဖိုင်တစ်ခုတည်းထဲကို ပေါင်းထည့်ပေးလိုက်ပါတယ်။
3. **စစ်ဆေးခြင်း (Testing):** ဒေါင်းလုဒ်ဆွဲထားတဲ့ rules တွေထဲမှာ error ပါသလား၊ Suricata version နဲ့ ကိုက်ညီရဲ့လားဆိုတာကို အလိုအလျောက် စစ်ဆေးပေးပါတယ်။
4. **နေရာချပေးခြင်း:** အားလုံးအဆင်ပြေရင် အဲဒီ rule ဖိုင်ကို ပုံမှန်အားဖြင့် `/var/lib/suricata/rules/suricata.rules` ဆိုတဲ့ လမ်းကြောင်းမှာ သွားသိမ်းပေးပါတယ်။

---

### ၂။ ဘာကြောင့် အသုံးပြုဖို့ လိုအပ်သလဲ?

Network တိုက်ခိုက်မှု ပုံစံတွေ (Cyber Attacks) က နေ့တိုင်း အသစ်အသစ်တွေ ထွက်ပေါ်နေပါတယ်။ အကယ်၍ သင်က rules တွေကို update မလုပ်ထားရင် Suricata က တိုက်ခိုက်မှုအသစ်တွေကို မသိတဲ့အတွက် ကာကွယ်ပေးနိုင်မှာ မဟုတ်ပါဘူး။ ဒါကြောင့် အနည်းဆုံး တစ်ပတ်တစ်ကြိမ် သို့မဟုတ် နေ့စဉ် update လုပ်ပေးဖို့ အကြံပြုလိုပါတယ်။

---

### ၃။ နောက်ထပ် အသုံးဝင်တဲ့ Command များ

`suricata-update` နဲ့ တွဲသုံးလေ့ရှိတဲ့ command အချို့ကို ဖော်ပြပေးလိုက်ပါတယ်-

- **Rule ရင်းမြစ်တွေကို ကြည့်ရန်:**

```bash
sudo suricata-update list-sources
```

_(ဘယ်လို rules အုပ်စုတွေ ရှိသလဲဆိုတာ ကြည့်တာပါ)_

- **တခြား rule အုပ်စုတွေကိုပါ ထည့်သွင်းရန်:**

```bash
sudo suricata-update enable-source <source-name>
```

_(ဥပမာ- `sslbl/ssl-fp-blacklist` စသဖြင့်)_

- **Update လုပ်ပြီးရင် Suricata ကို အသိပေးရန်:**
  Rule တွေ update ဖြစ်သွားတာကို Suricata က သိဖို့အတွက် reload လုပ်ပေးရပါတယ်။

```bash
sudo suricata-update
sudo systemctl reload suricata
```

### ၁။ `default-rule-path` သတ်မှတ်ရခြင်း အကြောင်းအရင်း

`default-rule-path: /var/lib/suricata/rules` ဆိုတာက Suricata ကို **"ငါသုံးမယ့် Rule ဖိုင်တွေ အားလုံးကို ဒီ Folder ထဲမှာပဲ လာရှာပါ"** လို့ လမ်းညွှန်ပေးလိုက်တာပါ။

- **အဆင်ပြေမှု:** ဒါကို သတ်မှတ်ထားရင် `rule-files:` အောက်မှာ ဖိုင်နာမည်တွေ ရေးတဲ့အခါ လမ်းကြောင်းအပြည့်အစုံ (ဥပမာ- `/var/lib/suricata/rules/suricata.rules`) လိုက်ရေးစရာ မလိုတော့ဘဲ `suricata.rules` လို့ပဲ နာမည်တိုလေး ရေးလိုက်ရုံနဲ့ Suricata က သိသွားမှာ ဖြစ်ပါတယ်။
- **စနစ်တကျရှိမှု:** Rules တွေ အားလုံးကို တစ်နေရာတည်းမှာ စုစည်းထားနိုင်ဖို့ ဖြစ်ပါတယ်။

---

### ၂။ `sudo suricata -T -c /etc/suricata/suricata.yaml` ရဲ့ အဓိပ္ပာယ်

ဒီ command က Suricata ကို တကယ်အလုပ်မခိုင်းသေးခင် **"စမ်းသပ်စစ်ဆေးခြင်း (Test Mode)"** နဲ့ ပတ်သက်ပါတယ်။

- **`-c` (Configuration):** Suricata အသုံးပြုရမယ့် settings ဖိုင်က ဘယ်မှာလဲဆိုတာ ညွှန်ပြတာပါ။ (နောက်က လမ်းကြောင်းပါရပါမယ်)။
- **`-T` (Test Configuration):** ဒါက အဓိကပါ။ သူက Suricata ကို **တကယ် Start မလုပ်ခိုင်းသေးဘဲ** ရေးထားတဲ့ configuration တွေ၊ စာလုံးပေါင်းတွေ၊ Rule တွေမှာ **အမှား (Syntax Error) ပါသလား** ဆိုတာကိုပဲ စစ်ပေးတာပါ။

---

### ၃။ ဒီ command ကို ဘာကြောင့် run ရတာလဲ? (အရေးကြီးဆုံးအချက်)

`.yaml` ဖိုင်ထဲမှာ တစ်ခုခု ပြင်လိုက်တယ်ဆိုပါစို့။ အကယ်၍ `-T` နဲ့ မစစ်ဘဲ ချက်ချင်း `restart` လုပ်လိုက်ရင်-

1. **စက်ရပ်သွားနိုင်ခြင်း:** အကယ်၍ စာလုံးပေါင်း တစ်လုံးမှားနေရင် သို့မဟုတ် path တစ်ခု မှားနေရင် Suricata service က ပွင့်မလာတော့ဘဲ Error တက်ပြီး ရပ်သွားပါလိမ့်မယ်။
2. **လုံခြုံရေး ဟာကွက်:** Suricata ရပ်သွားတဲ့အတွက် သင့် network ကို စောင့်ကြည့်မယ့်သူ မရှိတော့ဘဲ ဖြစ်သွားနိုင်ပါတယ်။

**`-T` ကို run လိုက်လို့ အောက်ပါစာသား ထွက်လာရင် စိတ်ချရပါပြီ:**

> `Configuration provided was successfully loaded. Exiting.`

ဒီစာသားတွေ့မှသာ Suricata ကို `restart` ချတာက အန္တရာယ်အကင်းဆုံး ဖြစ်ပါတယ်။

- `sudo systemctl restart suricata`

---

### အနှစ်ချုပ်

ဒီ command ကတော့ **"ပြင်လိုက်တဲ့ settings တွေက မှန်ကန်ရဲ့လား၊ Suricata က ကောင်းကောင်း အလုပ်လုပ်နိုင်ပါ့မလား"** ဆိုတာကို စိတ်ချရအောင် အရင်ဆုံး စစ်ဆေးကြည့်တဲ့ **Safety Check (လုံခြုံရေးစစ်ဆေးမှု)** ဖြစ်ပါတယ်။
